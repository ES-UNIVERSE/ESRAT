<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>GangaAI</title>
  <style>
    /* RESET */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; overflow: hidden; }
    body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #0f0f0f; color: #fff; }

    /* BACKGROUND */
    body::before { content: ""; position: fixed; inset: 0; background: radial-gradient(1200px 800px at 10% -10%, #1d1d1f 10%, #0a0a0a 60%); z-index: -2; }
    body::after { content: ""; position: fixed; inset: 0; backdrop-filter: blur(22px) saturate(180%); background: rgba(255,255,255,0.05); z-index: -1; transition: backdrop-filter .3s ease, background .3s ease; }
    body.blur::after { backdrop-filter: blur(28px) saturate(220%); background: rgba(255,255,255,0.10); }

    /* HEADER */
    header { position: fixed; top: 0; left: 0; right: 0; height: 60px; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 20px; font-weight: 600; background: rgba(255,255,255,0.06); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.12); z-index: 200; }
    .brand { letter-spacing: .3px; transition: opacity 0.3s ease; }
    .brand.hidden { opacity: 0; }
    .listening { position: absolute; display: flex; align-items: center; gap: 6px; font-size: 16px; font-weight: 500; opacity: 0; transition: opacity 0.3s ease; }
    .listening.active { opacity: 1; }
    .dot { width: 6px; height: 6px; border-radius: 50%; background: #34c759; animation: pulse 1.2s infinite ease-in-out; }
    .dot:nth-child(2){ animation-delay:.15s } .dot:nth-child(3){ animation-delay:.3s }
    @keyframes pulse { 0%,100%{ transform: scale(.8); opacity:.5 } 50%{ transform: scale(1.3); opacity:1 } }

    /* HAMBURGER / SIDEBAR TOGGLE */
    .menu { position: absolute; left: 10px; top: 10px; width: 40px; height: 40px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.06); display: grid; place-items:center; cursor: pointer; transition: transform .15s ease; }
    .menu:active { transform: scale(0.95); }
    .menu svg { width: 22px; height: 22px; fill: none; stroke: #fff; stroke-width: 2; stroke-linecap: round; }

    /* CHAT CONTAINER */
    .chat-container { position: absolute; top: 60px; bottom: 78px; left: 0; right: 0; overflow-y: auto; overflow-x: hidden; padding: 14px; display: flex; flex-direction: column; gap: 12px; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
    .chat-container::-webkit-scrollbar { display: none; }

    .chat-bubble { max-width: 82%; padding: 12px 16px; border-radius: 18px; font-size: 15px; line-height: 1.45; word-wrap: break-word; overflow-wrap: anywhere; white-space: pre-wrap; animation: pop .25s ease; }
    .user { align-self: flex-end; background: linear-gradient(135deg, #007aff, #5ac8fa); color: #fff; border-bottom-right-radius: 6px; }
    .bot { align-self: flex-start; background: rgba(255,255,255,0.10); border: 1px solid rgba(255,255,255,0.10); backdrop-filter: blur(10px); border-bottom-left-radius: 6px; }
    @keyframes pop { from{ opacity: 0; transform: translateY(8px) } to{ opacity:1; transform: translateY(0) } }

    /* TYPING INDICATOR */
    .typing { display: inline-flex; gap: 4px; align-items: center; }
    .typing .t { width:6px; height:6px; border-radius:50%; background:#d1d1d6; animation: type 1s infinite; }
    .typing .t:nth-child(2){ animation-delay:.15s } .typing .t:nth-child(3){ animation-delay:.3s }
    @keyframes type { 0%,100%{ transform: translateY(0); opacity:.5 } 50%{ transform: translateY(-4px); opacity:1 } }

    /* INPUT AREA */
    .input-area { position: fixed; bottom: 0; left: 0; right: 0; height: 78px; background: rgba(255,255,255,0.06); border-top: 1px solid rgba(255,255,255,0.12); backdrop-filter: blur(10px); display: flex; align-items: center; padding: 10px; gap: 10px; }
    .field-wrap { position: relative; flex: 1; height: 48px; }
    .field { position: absolute; inset: 0; display: flex; align-items: center; border-radius: 24px; background: rgba(255,255,255,0.10); border: 1px solid rgba(255,255,255,0.12); padding: 0 14px; overflow: hidden; }
    .field input { flex: 1; height: 44px; border: none; outline: none; font-size: 16px; background: transparent; color: #fff; }

    /* LIVE MIC VISUALIZER - covers entire input field */
    .visualizer { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; gap: 3px; padding: 0 18px; background: rgba(255,255,255,0.10); border-radius: 24px; }
    .bar { width: 4px; background: linear-gradient(180deg, #34c759, #30d158); border-radius: 2px; height: 10px; }
    
    /* MIC BUTTON */
    .mic-btn { width: 48px; height: 48px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.12); background: linear-gradient(135deg, #ff3b30, #ff2d55); display: grid; place-items: center; cursor: pointer; transition: transform .12s ease, filter .2s ease; }
    .mic-btn:active { transform: scale(.95); }
    .mic-btn svg { width: 22px; height: 22px; fill: #fff; }
    .mic-btn.recording { background: linear-gradient(135deg, #ff453a, #ff375f); box-shadow: 0 0 0 8px rgba(255,56,95,0.15); }

    /* SIDEBAR */
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.25); opacity: 0; pointer-events: none; transition: opacity .25s ease; z-index: 250; }
    .overlay.show { opacity: 1; pointer-events: auto; }
    .sidebar { position: fixed; top: 10px; left: 10px; bottom: 10px; width: 86%; max-width: 360px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.12); border-radius: 22px; backdrop-filter: blur(18px); transform: translateX(-120%); transition: transform .28s cubic-bezier(.2,.8,.2,1); z-index: 300; display: flex; flex-direction: column; overflow: hidden; }
    .sidebar.show { transform: translateX(0); }
    .side-head { display:flex; align-items:center; justify-content: space-between; padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.12); }
    .side-title { font-weight: 600; font-size: 16px; }
    .new-chat-btn { padding: 8px 12px; border-radius: 10px; background: rgba(255,255,255,0.10); border: 1px solid rgba(255,255,255,0.12); color: #fff; font-size: 14px; cursor: pointer; transition: transform .1s ease; }
    .new-chat-btn:active { transform: scale(0.95); }
    .side-search { margin: 10px 12px; display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.10); border: 1px solid rgba(255,255,255,0.12); border-radius: 14px; padding: 8px 10px; }
    .side-search input { flex:1; border:none; outline:none; background:transparent; color:#fff; font-size:14px; }

    .chats { overflow-y:auto; padding: 8px; display:flex; flex-direction:column; gap:8px; }
    .chat-item { display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px 12px; border-radius:14px; background: rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.10); cursor: pointer; transition: background .2s ease, transform .1s ease; }
    .chat-item:hover { background: rgba(255,255,255,0.10); }
    .chat-name { font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .chip { font-size: 11px; opacity:.7 }
    .actions { display:flex; gap:6px; }
    .icon-btn { width:28px; height:28px; display:grid; place-items:center; border-radius: 10px; border: 1px solid rgba(255,255,255,0.14); background: rgba(255,255,255,0.08); transition: transform .1s ease; }
    .icon-btn:active{ transform: scale(.95) }
    .icon-btn svg { width:16px; height:16px; stroke:#fff; stroke-width:2; fill:none; }

    /* PULL-TO-REFRESH cue */
    .pull-cue { position: absolute; top: 62px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0; transition: opacity .2s ease; pointer-events: none; }
    .pull-cue.show { opacity: .8 }

    @media (min-width: 768px){ .chat-bubble{ max-width: 720px } .sidebar{ width: 360px } }
  </style>
</head>
<body>
  <header>
    <div class="menu" id="menuBtn" aria-label="Open sidebar" title="Menu">
      <svg viewBox="0 0 24 24" id="menuIcon"><path d="M4 7h16M4 12h16M4 17h16"/></svg>
    </div>
    <div class="brand">GangaAI</div>
    <div class="listening" id="listening">
      <span>Listening</span>
      <div class="dot"></div><div class="dot"></div><div class="dot"></div>
    </div>
  </header>

  <div class="pull-cue" id="pullCue">â†“ pull to clear</div>

  <div class="chat-container" id="chat"></div>

  <div class="input-area">
    <div class="field-wrap">
      <div class="field" id="field">
        <input id="userInput" placeholder="Ask anything..." autocomplete="off" inputmode="text" />
        <!-- visualizer injected here on record -->
      </div>
    </div>
    <button class="mic-btn" id="micBtn" aria-label="Start voice input">
      <svg viewBox="0 0 24 24"><path d="M12 15c1.66 0 3-1.34 3-3V6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3z" fill="#fff"/><path d="M17.3 11c0 3.04-2.46 5.5-5.5 5.5S6.3 14.04 6.3 11H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-1.7z" fill="#fff"/></svg>
    </button>
  </div>

  <!-- Sidebar + overlay -->
  <div class="overlay" id="overlay"></div>
  <aside class="sidebar" id="sidebar" aria-label="Conversations">
    <div class="side-head">
      <div class="side-title">Conversations</div>
      <button class="new-chat-btn" id="newChatBtn">+ New Chat</button>
    </div>
    <div class="side-search">
      <svg viewBox="0 0 24 24" width="16" height="16" stroke="#fff" stroke-width="2" fill="none"><circle cx="11" cy="11" r="7"/><path d="M20 20l-3-3"/></svg>
      <input id="searchChats" placeholder="Search chats" />
    </div>
    <div class="chats" id="chatList"></div>
  </aside>

  <script>
    // ====== STATE & STORAGE ======
    const chatEl = document.getElementById('chat');
    const input = document.getElementById('userInput');
    const field = document.getElementById('field');
    const micBtn = document.getElementById('micBtn');
    const listening = document.getElementById('listening');
    const brand = document.querySelector('.brand');
    const menuBtn = document.getElementById('menuBtn');
    const menuIcon = document.getElementById('menuIcon');
    const overlay = document.getElementById('overlay');
    const sidebar = document.getElementById('sidebar');
    const chatList = document.getElementById('chatList');
    const searchChats = document.getElementById('searchChats');
    const pullCue = document.getElementById('pullCue');
    const newChatBtn = document.getElementById('newChatBtn');

    const STORAGE_KEY = 'gangaai_chats_v1';
    let chats = loadChats();
    let currentId = chats.length ? chats[0].id : createChat().id; // latest first
    let audioContext = null;
    let analyser = null;
    let microphone = null;
    let javascriptNode = null;
    let bars = [];
    let animationId = null;

    function uid(){ return 'c_' + Math.random().toString(36).slice(2,9); }
    function now(){ return Date.now(); }
    function loadChats(){ try{ const d = JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); return Array.isArray(d)? d.sort((a,b)=>b.updated-a.updated):[] }catch{ return [] } }
    function saveChats(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(chats)); renderChatList(); }

    function createChat(title='New Chat'){ 
      const id = uid(); 
      const chat = { id, title, messages: [], created: now(), updated: now() }; 
      chats.unshift(chat); 
      saveChats(); 
      return chat; 
    }
    
    function getChat(id){ return chats.find(c=>c.id===id); }

    // ====== RENDER ======
    function renderChat(id=currentId){ 
      const c = getChat(id); 
      if(!c) return; 
      chatEl.innerHTML=''; 
      c.messages.forEach(m=> addBubble(m.role,m.content,false)); 
      scrollToBottom(); 
    }

    function addBubble(role, text, push=true){
      if(push){ 
        const c = getChat(currentId); 
        c.messages.push({ role, content: text, ts: now() }); 
        c.updated = now(); 
        saveChats(); 
      }
      const b = document.createElement('div'); 
      b.className = `chat-bubble ${role}`; 
      chatEl.appendChild(b);
      if(role==='bot' && typewriterEnabled){ 
        typewriter(b, text); 
      } else { 
        b.textContent = text; 
      }
      scrollToBottom();
    }

    function showTyping(){ 
      const wrap = document.createElement('div'); 
      wrap.className = 'chat-bubble bot'; 
      const t = document.createElement('div'); 
      t.className='typing'; 
      t.innerHTML = '<span class="t"></span><span class="t"></span><span class="t"></span>'; 
      wrap.appendChild(t); 
      chatEl.appendChild(wrap); 
      scrollToBottom(); 
      return wrap; 
    }

    function scrollToBottom(){ chatEl.scrollTop = chatEl.scrollHeight; }

    function renderChatList(filter=''){ 
      chatList.innerHTML=''; 
      const q = filter.trim().toLowerCase(); 
      chats.filter(c=> !q || c.title.toLowerCase().includes(q)).forEach(c=> chatList.appendChild(chatListItem(c))); 
    }

    function chatListItem(c){ 
      const item = document.createElement('div'); 
      item.className='chat-item'; 
      item.dataset.id=c.id; 
      item.addEventListener('click', (e)=>{ 
        if(e.target.closest('.actions')) return; 
        currentId=c.id; 
        renderChat(); 
        closeSidebar(); 
      });
      
      const left = document.createElement('div'); 
      left.style.minWidth='0';
      
      const name = document.createElement('div'); 
      name.className='chat-name'; 
      name.textContent=c.title || 'Untitled';
      
      const chip = document.createElement('div'); 
      chip.className='chip'; 
      chip.textContent = new Date(c.updated).toLocaleString();
      
      left.appendChild(name); 
      left.appendChild(chip);
      
      const actions = document.createElement('div'); 
      actions.className='actions';
      actions.appendChild(iconBtn('âœï¸', ()=> renameChat(c.id)));
      actions.appendChild(iconBtnSVG('delete', ()=> deleteChat(c.id)));
      actions.appendChild(iconBtnSVG('export', ()=> exportChat(c.id)));
      
      item.appendChild(left); 
      item.appendChild(actions);
      return item; 
    }

    function iconBtn(label, onClick){ 
      const b=document.createElement('button'); 
      b.className='icon-btn'; 
      b.textContent=label; 
      b.addEventListener('click', (e)=>{ 
        e.stopPropagation(); 
        onClick(); 
      }); 
      return b; 
    }

    function iconBtnSVG(kind, onClick){ 
      const b=document.createElement('button'); 
      b.className='icon-btn'; 
      b.innerHTML = kind==='delete'
        ? '<svg viewBox="0 0 24 24"><path d="M3 6h18M8 6v14a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6M9 6l1-2h4l1 2"/></svg>'
        : '<svg viewBox="0 0 24 24"><path d="M12 3v12"/><path d="M7 8l5-5 5 5"/><path d="M5 21h14"/></svg>';
      b.addEventListener('click', (e)=>{ 
        e.stopPropagation(); 
        onClick(); 
      }); 
      return b; 
    }

    // ====== CHAT LOGIC ======
    let typewriterEnabled = true;
    function sendText(text){ 
      if(!text) return; 
      addBubble('user', text); 
      input.value=''; 
      const typing = showTyping(); 
      setTimeout(()=>{ 
        typing.remove(); 
        addBubble('bot', generateBotReply(text)); 
      }, 600 + Math.min(1200, text.length*30)); 
    }

    function generateBotReply(msg){ 
      const replies = [
        "Interestingâ€¦ tell me more!", 
        "I'm here to help you â¤", 
        "That sounds cool!",
        "Can you explain a bit more?", 
        "I like how you're thinking ðŸ¤”", 
        "Apple vibes, right? ðŸâœ¨"
      ]; 
      return replies[Math.floor(Math.random()*replies.length)]; 
    }

    function typewriter(el, text){ 
      let i=0; 
      const id=setInterval(()=>{ 
        el.textContent += text[i++]; 
        if(i>=text.length) clearInterval(id); 
      }, 12); 
    }

    input.addEventListener('keydown', (e)=>{ 
      if(e.key==='Enter'){ 
        e.preventDefault(); 
        sendText(input.value.trim()); 
      } 
    });

    // Pull-to-refresh (clear current chat)
    let startY=null, pulling=false; 
    chatEl.addEventListener('touchstart', (e)=>{ 
      if(chatEl.scrollTop===0){ 
        startY = e.touches[0].clientY; 
        pulling=true; 
      } 
    });
    
    chatEl.addEventListener('touchmove', (e)=>{ 
      if(!pulling) return; 
      const dy = e.touches[0].clientY - startY; 
      if(dy>40){ 
        pullCue.classList.add('show'); 
      } else { 
        pullCue.classList.remove('show'); 
      } 
    });
    
    chatEl.addEventListener('touchend', ()=>{ 
      if(pullCue.classList.contains('show')){ 
        clearCurrentChat(); 
      } 
      pullCue.classList.remove('show'); 
      pulling=false; 
      startY=null; 
    });

    function clearCurrentChat(){ 
      const c=getChat(currentId); 
      if(!c) return; 
      c.messages=[]; 
      c.updated=now(); 
      saveChats(); 
      renderChat(); 
    }

    // ====== SIDEBAR ======
    function openSidebar(){ 
      sidebar.classList.add('show'); 
      overlay.classList.add('show'); 
      document.body.classList.add('blur'); 
      menuBtn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 6L18 18M6 18L18 6" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>'; 
    }
    
    function closeSidebar(){ 
      sidebar.classList.remove('show'); 
      overlay.classList.remove('show'); 
      document.body.classList.remove('blur'); 
      menuBtn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M4 7h16M4 12h16M4 17h16" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>'; 
    }

    menuBtn.addEventListener('click', ()=>{ 
      if(sidebar.classList.contains('show')) closeSidebar(); 
      else openSidebar(); 
    });
    
    overlay.addEventListener('click', closeSidebar);

    searchChats.addEventListener('input', ()=> renderChatList(searchChats.value));
    
    newChatBtn.addEventListener('click', () => {
      const newChat = createChat();
      currentId = newChat.id;
      renderChat();
      closeSidebar();
    });

    function renameChat(id){ 
      const c=getChat(id); 
      if(!c) return; 
      const t = prompt('Rename chat:', c.title||''); 
      if(t !== null) { 
        c.title = t.trim()||'Untitled'; 
        c.updated=now(); 
        saveChats(); 
        renderChatList(searchChats.value); 
      }
    }
    
    function deleteChat(id){ 
      const i = chats.findIndex(c=>c.id===id); 
      if(i<0) return; 
      const isCurrent = chats[i].id===currentId; 
      chats.splice(i,1); 
      if(!chats.length) createChat(); 
      if(isCurrent) currentId = chats[0].id; 
      saveChats(); 
      renderChat(); 
    }
    
    function exportChat(id){ 
      const c = getChat(id); 
      if(!c) return; 
      const blob = new Blob([JSON.stringify(c, null, 2)], {type:'application/json'}); 
      const a = document.createElement('a'); 
      a.href = URL.createObjectURL(blob); 
      a.download = (c.title||'chat') + '.json'; 
      document.body.appendChild(a); 
      a.click(); 
      a.remove(); 
      setTimeout(()=> URL.revokeObjectURL(a.href), 1000); 
    }

    // ====== VOICE (Live Audio Visualization) ======
    let recording = false; 
    let interimBuffer='';
    
    function startMic(){ 
      if(recording) return; 
      recording = true; 
      micBtn.classList.add('recording'); 
      listening.classList.add('active'); 
      brand.classList.add('hidden');
      showVisualizer(); 
      startAudioVisualization();
    }

    function stopMic(){ 
      if(!recording) return; 
      recording=false; 
      micBtn.classList.remove('recording'); 
      listening.classList.remove('active'); 
      brand.classList.remove('hidden');
      hideVisualizer();
      stopAudioVisualization();
      
      // Auto-send the captured text
      const text = (input.value + ' ' + (interimBuffer||'')).trim(); 
      interimBuffer=''; 
      if(text) sendText(text);
    }

    function toggleMic(){ 
      if(recording) stopMic(); 
      else startMic(); 
    }
    
    micBtn.addEventListener('click', toggleMic);

    function showVisualizer(){ 
      input.style.visibility='hidden'; 
      let v=document.createElement('div'); 
      v.className='visualizer'; 
      v.id='viz'; 
      for(let i=0;i<8;i++){ 
        const b=document.createElement('div'); 
        b.className='bar'; 
        b.style.height = '10px';
        v.appendChild(b); 
        bars.push(b);
      } 
      field.appendChild(v); 
    }
    
    function hideVisualizer(){ 
      const v=document.getElementById('viz'); 
      if(v) v.remove(); 
      input.style.visibility='visible'; 
      bars = [];
    }
    
    function startAudioVisualization() {
      try {
        // Create audio context
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        analyser.fftSize = 256;
        
        // Get microphone input
        navigator.mediaDevices.getUserMedia({ audio: true, video: false })
          .then(function(stream) {
            microphone = audioContext.createMediaStreamSource(stream);
            javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);
            
            microphone.connect(analyser);
            analyser.connect(javascriptNode);
            javascriptNode.connect(audioContext.destination);
            
            javascriptNode.onaudioprocess = function() {
              const array = new Uint8Array(analyser.frequencyBinCount);
              analyser.getByteFrequencyData(array);
              
              // Update visualization
              if (bars.length > 0) {
                for (let i = 0; i < bars.length; i++) {
                  const value = array[i * 4] / 255;
                  const height = Math.max(10, value * 44);
                  bars[i].style.height = height + 'px';
                }
              }
            };
          })
          .catch(function(err) {
            console.error('Error getting microphone access:', err);
            // Fallback to animation if microphone access is denied
            animateBars();
          });
      } catch (e) {
        console.error('Error initializing audio visualization:', e);
        // Fallback to animation if Web Audio API is not supported
        animateBars();
      }
    }
    
    function stopAudioVisualization() {
      if (javascriptNode) {
        javascriptNode.disconnect();
        javascriptNode = null;
      }
      if (analyser) {
        analyser.disconnect();
        analyser = null;
      }
      if (microphone) {
        microphone.disconnect();
        microphone = null;
      }
      if (audioContext) {
        audioContext.close();
        audioContext = null;
      }
      
      if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
      }
    }
    
    function animateBars() {
      // Fallback animation when microphone access isn't available
      let time = 0;
      
      function updateBars() {
        time += 0.1;
        for (let i = 0; i < bars.length; i++) {
          const height = 10 + Math.abs(Math.sin(time + i * 0.5) * 34);
          bars[i].style.height = height + 'px';
        }
        if (recording) {
          animationId = requestAnimationFrame(updateBars);
        }
      }
      
      animationId = requestAnimationFrame(updateBars);
    }

    // TAP OUTSIDE SIDEBAR CLOSE (already via overlay), also prevent background scroll when open
    overlay.addEventListener('touchmove', (e)=> e.preventDefault(), {passive:false});

    // INIT
    renderChat(); 
    renderChatList();
  </script>
</body>
</html>